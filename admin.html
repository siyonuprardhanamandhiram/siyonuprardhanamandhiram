<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | Siyonu Prardhana Mandhiram</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #0a0a0f;
            color: #fff;
            margin: 0; padding: 20px;
            display: flex; justify-content: center; min-height: 100vh;
        }
        .container { max-width: 600px; width: 100%; }
        
        /* LOGIN OVERLAY */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 999;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
        .login-box {
            background: #1a1a20; padding: 40px; border-radius: 10px; border: 1px solid #d4af37; text-align: center;
        }
        input, textarea {
            width: 100%; padding: 12px; margin: 10px 0;
            background: #2a2a30; border: 1px solid #444; color: #fff; border-radius: 5px;
        }
        button {
            padding: 12px 30px; background: #d4af37; border: none; color: #000;
            font-weight: bold; cursor: pointer; border-radius: 5px; text-transform: uppercase;
        }
        
        /* DASHBOARD */
        #dashboard { display: none; }
        .card { background: #141419; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #333; }
        h2 { color: #d4af37; font-family: 'Playfair Display', serif; }
        
        .post-item {
            background: #1f1f25; padding: 15px; margin-bottom: 10px; border-radius: 5px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .delete-btn { background: #800000; color: #fff; padding: 5px 10px; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-box">
            <h2 style="margin-top:0;">Admin Login</h2>
            <input type="password" id="password-input" placeholder="Enter Password">
            <button onclick="checkLogin()">Access Dashboard</button>
            <p id="error-msg" style="color: red; display: none; margin-top: 10px;">Incorrect Password!</p>
        </div>
    </div>

    <div id="dashboard" class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2>Daily Posts Manager</h2>
            <a href="index.html" style="color: #d4af37; text-decoration: none;">View Website <i class="fas fa-external-link-alt"></i></a>
        </div>

        <div class="card">
            <h3>Create New Post</h3>
            <input type="text" id="post-title" placeholder="Post Title (e.g., Sunday Service Highlights)">
            <textarea id="post-desc" rows="4" placeholder="Write your message here..."></textarea>
            
            <label style="display: block; margin-top: 10px; color: #aaa; font-size: 0.9rem;">Upload Image (Optional):</label>
            <input type="file" id="post-image" accept="image/*">
            
            <button onclick="addPost()" style="width: 100%; margin-top: 10px;">Publish Post</button>
        </div>

        <div class="card">
            <h3>Recent Posts</h3>
            <div id="admin-posts-list">
                </div>
            <button onclick="clearAll()" style="background: #333; color: #fff; width: 100%; margin-top: 10px;">Clear All Posts</button>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const ADMIN_PASSWORD = "admin123"; // CHANGE THIS PASSWORD

        // 1. LOGIN LOGIC
        function checkLogin() {
            const input = document.getElementById('password-input').value;
            if (input === ADMIN_PASSWORD) {
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadAdminPosts();
            } else {
                document.getElementById('error-msg').style.display = 'block';
            }
        }

        // 2. CREATE POST LOGIC
        function addPost() {
            const title = document.getElementById('post-title').value;
            const desc = document.getElementById('post-desc').value;
            const imageInput = document.getElementById('post-image');
            
            if (!title || !desc) { alert("Please fill in Title and Description"); return; }

            const date = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

            // Handle Image (Convert to Base64 to store in text)
            if (imageInput.files && imageInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    savePostToStorage(title, desc, date, e.target.result);
                };
                reader.readAsDataURL(imageInput.files[0]);
            } else {
                savePostToStorage(title, desc, date, null);
            }
        }

        function savePostToStorage(title, desc, date, image) {
            const newPost = { id: Date.now(), title, desc, date, image };
            
            // Get existing posts
            const posts = JSON.parse(localStorage.getItem('siyonu_posts')) || [];
            posts.push(newPost);
            
            // Save back to Local Storage
            localStorage.setItem('siyonu_posts', JSON.stringify(posts));
            
            // Reset Form
            document.getElementById('post-title').value = '';
            document.getElementById('post-desc').value = '';
            document.getElementById('post-image').value = '';
            
            alert("Post Published Successfully!");
            loadAdminPosts();
        }

        // 3. DISPLAY POSTS IN ADMIN
        function loadAdminPosts() {
            const list = document.getElementById('admin-posts-list');
            const posts = JSON.parse(localStorage.getItem('siyonu_posts')) || [];
            
            list.innerHTML = '';
            if (posts.length === 0) list.innerHTML = '<p style="color:#666;">No posts yet.</p>';

            posts.reverse().forEach(post => {
                list.innerHTML += `
                    <div class="post-item">
                        <div>
                            <strong>${post.title}</strong><br>
                            <small style="color:#888;">${post.date}</small>
                        </div>
                        <button class="delete-btn" onclick="deletePost(${post.id})"><i class="fas fa-trash"></i></button>
                    </div>
                `;
            });
        }

        // 4. DELETE POST
        function deletePost(id) {
            if(!confirm("Delete this post?")) return;
            let posts = JSON.parse(localStorage.getItem('siyonu_posts')) || [];
            posts = posts.filter(post => post.id !== id);
            localStorage.setItem('siyonu_posts', JSON.stringify(posts));
            loadAdminPosts();
        }

        function clearAll() {
            if(confirm("Are you sure you want to delete ALL posts?")) {
                localStorage.removeItem('siyonu_posts');
                loadAdminPosts();
            }
        }
    </script>
</body>
</html>
